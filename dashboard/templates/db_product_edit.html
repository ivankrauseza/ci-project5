{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container">
    <div class="row">

        <div class="col-sm-12 col-md-12">
            <small>
                <a href="{% url 'db_products' %}">
                    Back to Product List
                </a>
            </small>
            <h1>Edit Product</h1>
        </div>

        <div class="col-sm-12 col-md-6">

            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ product_form.as_p }}
                <button type="submit">Submit</button>
            </form>
            
            <hr>

            <div class="row">
                <div class="col-sm-6 text-start">
                    <small>Created:<br>{{ product.created }}</small>
                </div>
                <div class="col-sm-6 text-start">
                    <small>Updated:<br>{{ product.updated }}</small>
                </div>
            </div>

            <hr>
            <ul>
                <li>Save as stripe product?</li>
                <li>If blocked, do not allow unblock unless ALL required fields are completed</li>
                <li>Blocked toggle</li>
                <li>Add image upload functionality</li>
            </ul>
            <hr>
            <!-- Delete button with confirmation prompt -->
            <form method="post" action="{% url 'db_product_delete' pk=product.pk %}" onsubmit="return confirm('Are you sure you want to delete this product?');">
                {% csrf_token %}
                <button type="submit">Delete Product</button>
            </form>
            <hr>

        </div>
        <div class="col-sm-12 col-md-6">
            IMAGES
            <ul>
                {% for file in files %}
                  <li>
                    <a href="{{ file.file.url }}" target="_blank" rel="noopener noreferrer">
                        {{ file.file.name }} - {{ file.type }} - {{ file.description }}
                    </a>
                    <form method="post" action="{% url 'delete_file' file.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" onclick="return confirm('Are you sure you want to delete this file?')">Delete</button>
                      </form>
                    </li>
                {% endfor %}
              </ul>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                {{ file_form.as_p }}
                <button type="submit">Submit</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block postloadjs %}
<script>
    console.log('test');
</script>
{% endblock postloadjs %}